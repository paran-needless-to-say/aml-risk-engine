# 백엔드팀 요청사항 - 구체적 가이드

## 🎯 **현재 상황 요약**

현재 리스크 엔진이 **0점만 나오는 이유**:

- 모든 금액 기반 룰들이 **USD 변환이 필요**한데, ETH → USD 가격 정보가 없음
- 예: "10,000달러 이상 거래 시 고위험" 룰이 있는데, ETH 가격을 모르니까 판단 불가

## 📋 **백엔드팀에게 요청할 사항들**

### 🔴 **1단계: 즉시 필요 (가장 중요!)**

#### **A. ETH-USD 환율 정보**

```
리스크 분석을 위해 ETH 가격 정보가 필요함

방법 1) 트랜잭션과 함께 제공
{
  "hash": "0x123...",
  "value": "1500000000000000000",  // 1.5 ETH
  "timestamp": 1693066895,
  "eth_usd_price": 2000.50        // ← 이 시점의 ETH 가격
}

방법 2) 별도 API 엔드포인트
GET /api/price/eth-usd?timestamp=1693066895
→ {"price": 2000.50}

방법 3) 고정값으로 시작 (테스트용)
현재 ETH 가격을 $2000으로 고정해서 모든 트랜잭션에 적용
"
```

#### **B. 트랜잭션 추가 필드**

```
"현재 트랜잭션 데이터에 다음 필드들이 빠져있어서 일부 분석이 안됩니다:

- gasUsed: 실제 사용된 가스량
- transactionIndex: 블록 내 트랜잭션 순서
- blockNumber: 블록 번호

이 정보들도 함께 제공해주실 수 있나요?"
```

### 🟡 **2단계: 고급 기능용 (나중에 요청)**

#### **C. 주소 생성 시점 정보**

```
"신규 주소 탐지를 위해 각 주소가 언제 처음 등장했는지 알 수 있나요?

{
  "address": "0x123...",
  "first_seen": 1693000000,  // 첫 트랜잭션 시점
  "is_new_address": true     // 7일 이내 생성된 주소인지
}
"
```

#### **D. 제재 명단 (컴플라이언스용)**

```
"컴플라이언스 룰 적용을 위해 제재 대상 주소 목록이 필요합니다.

OFAC, UN 등의 공식 제재 명단에서 암호화폐 주소들을 수집해서
다음 형태로 제공해주실 수 있나요?

{
  "sanctions_list": [
    {
      "address": "0x123...",
      "source": "OFAC",
      "reason": "North Korea Lazarus Group"
    }
  ]
}
"
```

---

## 💬 **백엔드팀에게 보낼 메시지 템플릿**

### **📧 1단계 요청 메시지**

```
제목: [리스크엔진] USD 가격 정보 추가 요청

안녕하세요!

현재 리스크 스코어링 엔진을 테스트하고 있는데,
모든 결과가 0점으로 나오는 이유를 찾았습니다.

**문제**: 금액 기반 룰들이 USD 변환을 필요로 하는데, ETH 가격 정보가 없어서 판단할 수 없음

**해결방법**: 트랜잭션 데이터에 ETH-USD 환율 정보 추가

**구체적 요청사항**:

1. **ETH 가격 정보** (가장 중요!)
   - 각 트랜잭션 시점의 ETH-USD 환율
   - 또는 현재 가격($2000)을 모든 트랜잭션에 고정 적용

2. **트랜잭션 추가 필드**
   - gasUsed (실제 사용 가스)
   - transactionIndex (블록 내 순서)
   - blockNumber (블록 번호)

이 정보만 추가해주시면 즉시 3개의 주요 룰이 활성화되어
의미있는 리스크 점수를 얻을 수 있습니다!

급하지 않으니 편하실 때 확인해주세요 😊
```

### **📧 2단계 요청 메시지 (나중에)**

```
제목: [리스크엔진] 고급 기능용 데이터 추가 요청

1단계가 완료된 후, 다음 기능들을 위해 추가 데이터가 필요합니다:

1. **주소 생성 시점** - 신규 주소 탐지용
2. **제재 명단** - 컴플라이언스 룰용
3. **ERC20 이벤트** - 승인-전송 패턴 탐지용

자세한 내용은 '백엔드에서_줘야_하는_데이터.md' 파일을 참고해주세요!
```

---

## 🚀 **단계별 효과**

### **1단계 완료 후 (USD 가격 추가)**

- **활성화되는 룰**: B-501, B-502, B-503
- **예상 효과**: 고액 거래, 스팸 거래 탐지 가능
- **리스크 점수**: 0점 → 실제 의미있는 점수

### **2단계 완료 후 (주소 메타데이터 추가)**

- **활성화되는 룰**: B-401, B-402
- **예상 효과**: 신규/휴면 주소 탐지 가능

### **3단계 완료 후 (제재 명단 추가)**

- **활성화되는 룰**: C-001
- **예상 효과**: 제재 대상과의 거래 탐지 가능

---

## 💡 **FAQ**

**Q: 왜 USD 가격이 필요한가요?**
A: 룰북의 대부분 임계값이 USD 기준입니다 (예: $10,000 이상 고위험). ETH 가격 없이는 1.5 ETH가 고액인지 소액인지 판단 불가능합니다.

**Q: 실시간 가격이 필요한가요?**
A: 아닙니다! 테스트 단계에서는 고정 가격($2000)으로도 충분합니다. 나중에 실시간으로 업그레이드 가능합니다.

**Q: 다른 토큰 가격도 필요한가요?**
A: 현재는 ETH만 있으면 됩니다. USDT, USDC 등은 나중에 추가 가능합니다.

---

