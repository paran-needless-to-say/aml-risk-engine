# 백엔드에서 줘야 하는 데이터

## 📋 **현재 구현된 룰북 기준 필수 데이터**

### 🔴 **즉시 필요한 데이터 (현재 룰 활성화용)**

#### **1. 기본 트랜잭션 데이터**

```json
{
  "hash": "0x...",
  "from": "0x...",
  "to": "0x...",
  "value": "1500000000000000000", // Wei 단위
  "gas": 21000,
  "gasPrice": "20000000000", // Wei 단위
  "gasUsed": 21000, // 실제 사용된 가스
  "timestamp": 1693066895, // Unix timestamp
  "blockNumber": 18000000,
  "transactionIndex": 0,
  "nonce": 345344,
  "transactionType": "2" // EIP-1559 타입
}
```

#### **2. USD 가격 변환 데이터**

```json
{
  "eth_usd_price": 2000.5, // ETH/USD 환율
  "timestamp": 1693066895, // 해당 시점 가격
  "token_prices": {
    // 다른 토큰들 (필요시)
    "USDT": 1.0,
    "USDC": 1.0
  }
}
```

#### **3. 주소 메타데이터**

```json
{
  "address": "0x...",
  "first_seen": 1693000000, // 주소 첫 등장 시간
  "last_active": 1693066895, // 마지막 활동 시간
  "address_type": "EOA", // EOA/Contract
  "is_contract": false,
  "contract_creation_tx": null
}
```

### 🟡 **고급 룰 활성화용 데이터 (선택적)**

#### **4. 제재 명단 데이터 (C-001용)**

```json
{
  "sanctions_list": [
    {
      "address": "0x...",
      "source": "OFAC", // OFAC/UN/EU
      "reason": "North Korea Lazarus Group",
      "added_date": "2023-01-01",
      "status": "active"
    }
  ]
}
```

#### **5. 믹서/프라이버시 서비스 목록 (E-101용)**

```json
{
  "mixer_contracts": [
    {
      "address": "0x...",
      "name": "Tornado Cash",
      "type": "mixer",
      "status": "sanctioned",
      "risk_level": "high"
    }
  ]
}
```

#### **6. ERC20 토큰 이벤트 (B-301용)**

```json
{
  "erc20_events": [
    {
      "type": "Approval",
      "from": "0x...",
      "to": "0x...",
      "value": "1000000000000000000",
      "timestamp": 1693066895,
      "tx_hash": "0x..."
    },
    {
      "type": "Transfer",
      "from": "0x...",
      "to": "0x...",
      "value": "1000000000000000000",
      "timestamp": 1693066900,
      "tx_hash": "0x..."
    }
  ]
}
```

---

## 🚀 **데이터 제공 방식 제안**

### **Option 1: 실시간 API 호출**

```python
# 백엔드 API 엔드포인트
GET /api/transactions/{address}?from_time=123456&to_time=789012
GET /api/prices/eth-usd?timestamp=123456
GET /api/sanctions/check/{address}
GET /api/address-metadata/{address}
```

### **Option 2: 배치 데이터 파일**

```
data/
├── transactions_batch_001.jsonl    # 트랜잭션 데이터
├── prices_daily.json              # 일별 가격 데이터
├── sanctions_list.json            # 제재 명단
├── mixer_list.json               # 믹서 목록
└── address_metadata.json         # 주소 메타데이터
```

---

## 📊 **데이터 우선순위**

### **🔴 Priority 1 (즉시 필요)**

1. **완전한 트랜잭션 데이터** - gasUsed, transactionIndex 추가
2. **USD 가격 데이터** - 고액 거래 룰 (B-501) 활성화용
3. **주소 생성 시점** - 신규 주소 룰 (B-401) 활성화용

### **🟡 Priority 2 (고급 기능용)**

4. **제재 명단** - 컴플라이언스 룰 (C-001) 활성화용
5. **믹서 목록** - 노출도 룰 (E-101) 활성화용
6. **ERC20 이벤트** - 이벤트 시퀀스 룰 (B-301) 활성화용

### **🟢 Priority 3 (미래 확장용)**

7. **VASP 정보** - KYC/Travel Rule 관련
8. **위험 라벨** - 랜섬웨어/DNM 탐지용
9. **국가 정보** - 고위험국 탐지용

---

## 💡 **현재 데이터로 활성화 가능한 룰들**

### ✅ **이미 작동하는 룰들**

- **B-101**: 버스트 거래 (10분) - `tx_frequency_per_hour` 사용
- **B-102**: 급속 연속 (1분) - `burst_pattern_score` 사용
- **B-103**: 비정상 타이밍 - `time_variance` 사용
- **B-203**: 팬아웃 패턴 - `fanout_degree` 사용
- **B-204**: 허브-스포크 - `fanin_degree`, `fanout_degree` 사용

### 🔶 **USD 가격만 추가하면 활성화**

- **B-501**: 고액 거래 - USD 변환 필요
- **B-502**: 마이크로 스팸 - USD 변환 필요
- **B-503**: 금액 반올림 반복 - USD 변환 필요

### ❌ **추가 데이터 필요**

- **C-001**: 제재 대상 접촉 - 제재 명단 필요
- **E-101**: 믹서 사용 - 믹서 주소 목록 필요
- **B-301**: 승인-유출 시퀀스 - ERC20 이벤트 필요
- **B-401**: 신규 주소 고액 - 주소 생성 시점 필요
- **B-402**: 휴면 주소 활성화 - 주소 활동 이력 필요

---

## 🎯 **권장 구현 순서**

1. **1단계**: USD 가격 데이터 추가 → B-501, B-502, B-503 활성화
2. **2단계**: 주소 메타데이터 추가 → B-401, B-402 활성화
3. **3단계**: 제재 명단 추가 → C-001 활성화
4. **4단계**: 믹서 목록 추가 → E-101 활성화
5. **5단계**: ERC20 이벤트 추가 → B-301 활성화

이 순서로 진행하면 단계별로 더 많은 룰들이 활성화되어 리스크 탐지 정확도가 점진적으로 향상됩니다! 🚀
